<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: table.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: table.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Render the 5-years rate history as a table.
 * @param {import("./api").RateHistoryResponse} rateHistory - The unserialized rate history fetch from API.
 * @returns {HTMLTableElement}
 */
export function renderRates (rateHistory) {
  const table = document.createElement('table')
  const tbody = document.createElement('tbody')
  table.appendChild(renderTableHeader())
  table.appendChild(tbody)

  for (const { z: { dateTime, open, close, high, low, volume } } of rateHistory.chart) {
    const tr = document.createElement('tr')
    tr.appendChild(createNodeWithText('td', dateTime.toISOString().split('T')[0]))
    for (const price of [open, close, high, low]) tr.appendChild(createNodeWithText('td', formatPriceUSD(price)))
    tr.appendChild(createNodeWithText('td', volume.toString()))
    tbody.appendChild(tr)
  }

  return table
}

/**
 * Returns the table thead element.
 * @returns {HTMLTableSectionElement}
 */
function renderTableHeader () {
  const thead = document.createElement('thead')
  const tr = thead.appendChild(document.createElement('tr'))
  tr.appendChild(createNodeWithText('th', 'Date'))
  tr.appendChild(createNodeWithText('th', 'Open price'))
  tr.appendChild(createNodeWithText('th', 'Close price'))
  tr.appendChild(createNodeWithText('th', 'High price'))
  tr.appendChild(createNodeWithText('th', 'Low price'))
  tr.appendChild(createNodeWithText('th', 'Volume'))
  return thead
}

/**
 * Returns a new element with an inner text, created such way it should not be vulnerable to XSS.
 * @see {@link https://stackoverflow.com/questions/52707031/does-innertext-prevent-xss}
 * @param {"td"|"th"} tagName - The kind of tag you want to create
 * @param {string} innerText - The content of element.innerText
 * @returns {HTMLTableDataCellElement | HTMLTableHeaderCellElement}
 */
function createNodeWithText (tagName, innerText) {
  if (!['td', 'th'].includes(tagName)) {
    throw new Error(`Refuse to create not whitelisted ${tagName} with arbitrary innerText`)
  }

  const element = document.createElement(tagName)
  element.innerText = innerText
  return element
}

/**
 * Format a price with 2 decimals in USD currency.
 * @param {number} price
 * @returns {string}
 */
function formatPriceUSD (price) {
  return '$' + price.toFixed(2)
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#apiGetRateHistory">apiGetRateHistory</a></li><li><a href="global.html#createNodeWithText">createNodeWithText</a></li><li><a href="global.html#formatPriceUSD">formatPriceUSD</a></li><li><a href="global.html#httpCheckCodeAndParseJson">httpCheckCodeAndParseJson</a></li><li><a href="global.html#httpGet">httpGet</a></li><li><a href="global.html#renderRates">renderRates</a></li><li><a href="global.html#renderTableHeader">renderTableHeader</a></li><li><a href="global.html#siteName">siteName</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.11</a> on Thu Sep 15 2022 18:56:55 GMT+0200 (heure d’été d’Europe centrale)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
